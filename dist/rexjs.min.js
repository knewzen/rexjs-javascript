/*!
 * RexJS v0.1.0
 * (c) 2017 nerdslabs
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.RexJS=n()}(this,function(){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=(function(){function e(e){this.value=e}function n(n){function t(r,i){try{var u=n[r](i),c=u.value;c instanceof e?Promise.resolve(c.value).then(function(e){t("next",e)},function(e){t("throw",e)}):o(u.done?"return":"normal",u.value)}catch(e){o("throw",e)}}function o(e,n){switch(e){case"return":r.resolve({value:n,done:!0});break;case"throw":r.reject(n);break;default:r.resolve({value:n,done:!1})}(r=r.next)?t(r.key,r.arg):i=null}var r,i;this._invoke=function(e,n){return new Promise(function(o,u){var c={key:e,arg:n,resolve:o,reject:u,next:null};i?i=i.next=c:(r=i=c,t(e,n))})},"function"!=typeof n.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}),t=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},r=function(){function o(e,t,r,i){n(this,o),this._context=e,this._callback=i,this.worker=t,this.module=r,this.data={},this.bind()}return t(o,[{key:"bind",value:function(){var e=this;this.connection=new WebSocket(this._context._options.websocketUrl+"?worker="+this.worker+"&module="+this.module),this.connection.onopen=this._bind,this.connection.onclose=this._unbind,this.connection.onmessage=function(n){e._message(n)}}},{key:"unbind",value:function(){this.connection.close()}},{key:"_bind",value:function(){}},{key:"_message",value:function(n){var t=JSON.parse(n.data);"undefined"!==e(t.error)?console.error("[RexJS] "+t.error):(this.data=t,this._callback(this.data))}},{key:"_unbind",value:function(){console.debug("[RexJS] worker: "+this.worker+", module: "+this.module+" disconnected")}}]),o}(),i={env:"production"},u=function(){function u(t){if(n(this,u),this._options=o({},i,t),"undefined"==("undefined"==typeof WebSocket?"undefined":e(WebSocket)))throw"[RexJS] WebSocket in not avaible in this browser!";if("undefined"==e(this._options.websocketUrl))throw"[RexJS] websocketUrl server url is not set in options!"}return t(u,[{key:"bindModule",value:function(n,t,o){if("undefined"!=(void 0===n?"undefined":e(n))){if("undefined"!=(void 0===t?"undefined":e(t)))return new r(this,n,t,o);console.error("[RexJS] module not presented!")}else console.error("[RexJS] worker not presented!")}}]),u}();return u.version="0.1.0",u});